<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>CR Gendarmerie</title>
<link href="manifest.json" rel="manifest"/>
<meta content="#2c3e50" name="theme-color"/>
<link href="icon-192.png" rel="apple-touch-icon"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<!-- Font Awesome pour les ic√¥nes -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>

<script src="libs/html5-qrcode.min.js"></script>
<link href="style.css" rel="stylesheet"/><script defer="True" src="script.js"></script></head>
<body>
<!-- Page d'accueil avec nouvelle pr√©sentation -->
<div class="home-page" id="homePage">
<h1 class="home-title">
    CR GENDARMERIE<br/>
<span class="sous-titre">LIMES Breil La Turbie DSI Tende</span>
</h1>
<div class="app-grid">
<button class="icon-button icon-infos" onclick="showPage('infosPage')">
<i class="fas fa-calendar-alt"></i>
<span>Informations</span>
</button>
<button class="icon-button icon-esr" onclick="showPage('esrPage')">
<i class="fas fa-user-shield"></i>
<span>ESR</span>
</button>
<button class="icon-button icon-materiel" onclick="showPage('materielPage')">
<i class="fas fa-video"></i>
<span>Mat√©riel</span>
</button>
<button class="icon-button icon-compteurs" onclick="showPage('vehiculesPage')">
<i class="fas fa-chart-bar"></i>
<span>Compteurs</span>
</button>
<button class="icon-button icon-esi" onclick="showPage('esiPage')">
<i class="fas fa-passport"></i>
<span>ESI</span>
</button>
<button class="icon-button icon-passeur" onclick="showPage('passeurPage')">
<i class="fas fa-user-secret"></i>
<span>Passeurs</span>
</button>
<button class="icon-button icon-obs" onclick="showPage('observationsPage')">
<i class="fas fa-eye"></i>
<span>Observations</span>
</button>
<button class="icon-button icon-deroulement" onclick="showPage('deroulementPage')">
<i class="fas fa-tasks"></i>
<span>D√©roulement</span>
</button>
<button class="icon-button icon-pulsar" onclick="showPage('pulsarPage')">
<i class="fas fa-fire"></i>
<span>Pulsar</span>
</button>
<button class="icon-button icon-cr" onclick="showPage('generatePage')">
<i class="fas fa-file-alt"></i>
<span>Compte Rendu</span>
</button>
<button class="icon-button icon-fiche" onclick="showPage('ficheIdentitePage')">
<i class="fas fa-id-card"></i>
<span>Fiche identit√©</span>
</button>
<button class="icon-button icon-visa" onclick="showPage('assistantVisaPage')">
<i class="fas fa-passport"></i>
<span>Assistant Visas</span>
</button>
<button class="icon-button icon-qr" id="scanQrBtn" onclick="showPage('qrPage')">
<i class="fas fa-qrcode"></i>
<span>QR Code</span>
</button>
    <!-- üü¶ BOUTON PROC√àS-VERBAL -->
<button class="icon-button icon-pv" onclick="showPage('pvPage')">
  <i class="fas fa-gavel"></i>
  <span>Proc√®s-verbal</span>
</button>
<!-- üî¥ BOUTON APPEL CORG -->
<button class="icon-button urgent" onclick="confirmCallCORG()">
  <i class="fas fa-phone"></i>
  <span>APPEL CORG</span>
</button>
</div>
<!-- üü¶ POPUP CONFIRMATION APPEL -->
<div id="popupCORG" class="popup-overlay">
  <div class="popup-box">
    <h3>‚ö†Ô∏è CONFIRMATION</h3>
    <p>Souhaitez-vous appeler le <strong>CORG ALPES-MARITIMES</strong> ?<br>
    Num√©ro : <strong>04 93 18 23 61</strong></p>
    <div class="popup-buttons">
      <button id="popupCallBtn" class="popup-btn call">üìû Appeler</button>
      <button id="popupCancelBtn" class="popup-btn cancel">Annuler</button>
    </div>
  </div>
</div>
</div>

<!-- Page Informations -->
<div class="page" id="infosPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Informations</div>
</div>
<div class="page-content">
<label for="siteSelect">Site :</label>
<select aria-label="S√©lection du site" id="siteSelect">
<option value="Breil">Breil</option>
<option value="La Turbie">La Turbie</option>
<option value="DSI Tende">DSI Tende</option>
</select>
<div class="flex-row">
<div class="flex-col">
<label for="dateInput">Date :</label>
<input id="dateInput" type="date"/>
</div>
<div class="flex-col">
<label for="heureDebutInput">Heure d√©but :</label>
<input id="heureDebutInput" type="time"/>
</div>
<div class="flex-col">
<label for="heureFinInput">Heure fin :</label>
<input id="heureFinInput" type="time"/>
</div>
</div>
</div>
</div>
<!-- Page ESR -->
<div class="page" id="esrPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">ESR (Effectif)</div>
</div>
<div class="page-content">
<div id="esrList"></div>
<div style="margin-top: 20px;">
<input id="esrGrade" placeholder="Grade" type="text"/>
<input id="esrNom" placeholder="Nom Pr√©nom" type="text"/>
<input id="esrNigend" placeholder="Nigend" type="text"/>
<input id="esrCRT" placeholder="CRT (ex: 06/1 Nice)" type="text"/>
<button class="blue" id="addEsrBtn">Ajouter ESR</button>
<button class="red" id="delEsrBtn">Supprimer dernier ESR</button>
</div>
<div class="small-note">Tous les champs doivent √™tre remplis pour ajouter un ESR</div>
</div>
</div>
<!-- Page Mat√©riel -->
<div class="page" id="materielPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Mat√©riel et utilisateurs</div>
</div>
<div class="page-content">
<div class="flex-row">
<div style="flex:2;">
<label>Cam√©ra n¬∞ :
          <input id="cameraNum" placeholder="Num√©ro cam√©ra" type="text"/>
</label>
</div>
<div style="flex:3;">
<label>Porteur cam√©ra (ESR) :
          <select id="cameraESR"></select>
</label>
</div>
</div>
<div class="flex-row">
<div style="flex:2;">
<label>Tablette n¬∞ 1 :
          <input id="tablette1Num" placeholder="N¬∞(ex: 6)" type="text"/>
</label>
</div>
<div style="flex:3;">
<label>Utilisateur tablette 1 (ESR) :
          <select id="tablette1ESR"></select>
</label>
</div>
</div>
<div class="flex-row">
<div style="flex:2;">
<label>Tablette n¬∞ 2 (optionnel) :
          <input id="tablette2Num" placeholder="N¬∞(ex: 7)" type="text"/>
</label>
</div>
<div style="flex:3;">
<label>Utilisateur tablette 2 (ESR) :
          <select id="tablette2ESR"></select>
</label>
</div>
</div>
<div style="margin-top:15px;">
<label>V√©hicule de service (immatriculation) :
        <input id="vehiculeService" placeholder="Ex: AB-123-CD" type="text"/>
</label>
</div>
</div>
</div>
<!-- Page V√©hicules/Compteurs -->
<div class="page" id="vehiculesPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Moyens / Personnes contr√¥l√©es</div>
</div>
<div class="page-content">
<div class="vehicle-card" id="trainCard">
<h3>Train</h3>
<div class="flex-row" style="align-items:center;">
<div>
<button class="plusminus minus" data-action="minus" data-field="vehicles" data-type="train">-</button>
<span id="trainVehiclesCount">0</span> v√©hicules
          <button class="plusminus plus" data-action="plus" data-field="vehicles" data-type="train">+</button>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cv" data-type="train">-</button>
<span id="trainCvCount">0</span> CV
          <button class="plusminus plus" data-action="plus" data-field="cv" data-type="train">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CV manuellement:
            <input class="manual-input" id="trainCvManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="trainCvAddManualBtn">Ajouter</button>
</label>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cf" data-type="train">-</button>
<span id="trainCfCount">0</span> CF
          <button class="plusminus plus" data-action="plus" data-field="cf" data-type="train">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CF manuellement:
            <input class="manual-input" id="trainCfManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="trainCfAddManualBtn">Ajouter</button>
</label>
</div>
</div>
</div>
<div class="vehicle-card" id="busCard">
<h3>Bus</h3>
<div class="flex-row" style="align-items:center;">
<div>
<button class="plusminus minus" data-action="minus" data-field="vehicles" data-type="bus">-</button>
<span id="busVehiclesCount">0</span> v√©hicules
          <button class="plusminus plus" data-action="plus" data-field="vehicles" data-type="bus">+</button>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cv" data-type="bus">-</button>
<span id="busCvCount">0</span> CV
          <button class="plusminus plus" data-action="plus" data-field="cv" data-type="bus">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CV manuellement:
            <input class="manual-input" id="busCvManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="busCvAddManualBtn">Ajouter</button>
</label>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cf" data-type="bus">-</button>
<span id="busCfCount">0</span> CF
          <button class="plusminus plus" data-action="plus" data-field="cf" data-type="bus">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CF manuellement:
            <input class="manual-input" id="busCfManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="busCfAddManualBtn">Ajouter</button>
</label>
</div>
</div>
</div>
<div class="vehicle-card" id="vlCard">
<h3>VL</h3>
<div class="flex-row" style="align-items:center;">
<div>
<button class="plusminus minus" data-action="minus" data-field="vehicles" data-type="vl">-</button>
<span id="vlVehiclesCount">0</span> v√©hicules
          <button class="plusminus plus" data-action="plus" data-field="vehicles" data-type="vl">+</button>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cv" data-type="vl">-</button>
<span id="vlCvCount">0</span> CV
          <button class="plusminus plus" data-action="plus" data-field="cv" data-type="vl">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CV manuellement:
            <input class="manual-input" id="vlCvManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="vlCvAddManualBtn">Ajouter</button>
</label>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cf" data-type="vl">-</button>
<span id="vlCfCount">0</span> CF
          <button class="plusminus plus" data-action="plus" data-field="cf" data-type="vl">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CF manuellement:
            <input class="manual-input" id="vlCfManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="vlCfAddManualBtn">Ajouter</button>
</label>
</div>
</div>
</div>
<div class="vehicle-card" id="plCard">
<h3>PL</h3>
<div class="flex-row" style="align-items:center;">
<div>
<button class="plusminus minus" data-action="minus" data-field="vehicles" data-type="pl">-</button>
<span id="plVehiclesCount">0</span> v√©hicules
          <button class="plusminus plus" data-action="plus" data-field="vehicles" data-type="pl">+</button>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cv" data-type="pl">-</button>
<span id="plCvCount">0</span> CV
          <button class="plusminus plus" data-action="plus" data-field="cv" data-type="pl">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CV manuellement:
            <input class="manual-input" id="plCvManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="plCvAddManualBtn">Ajouter</button>
</label>
</div>
<div style="margin-left:20px;">
<button class="plusminus minus" data-action="minus" data-field="cf" data-type="pl">-</button>
<span id="plCfCount">0</span> CF
          <button class="plusminus plus" data-action="plus" data-field="cf" data-type="pl">+</button>
</div>
<div>
<label style="margin-left:15px;">Ajouter CF manuellement:
            <input class="manual-input" id="plCfManual" inputmode="numeric" min="0" pattern="[0-9]*" placeholder="0" type="number"/>
<button class="add" id="plCfAddManualBtn">Ajouter</button>
</label>
</div>
</div>
</div>
</div>
</div>
<!-- Page ESI -->
<div class="page" id="esiPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">ESI Intercept√©(s)</div>
</div>
<div class="page-content">
<div id="esiList"></div>
<div style="margin-top: 20px;">
<input id="esiAge" placeholder="Majeur(e) ou mineur(e) automatique" readonly="" type="text">
<select aria-label="Sexe H/F" id="esiSexe">
<option value="">Homme/Femme</option>
<option value="Homme">Homme</option>
<option value="Femme">Femme</option>
</select>
<input id="esiAgeNum" min="0" oninput="majEsiStatut()" placeholder="√Çge (chiffre)" style="width: 100px;" type="number">
<input id="esiNationalite" placeholder="Nationalit√©" type="text">
<input id="esiLieu" placeholder="Lieu interpellation" type="text">
<label for="esiHeure">Heure interpellation :</label>
<input id="esiHeure" type="time">
<input id="esiSuites" placeholder="Suites donn√©es" type="text">
<button class="blue" id="addEsiBtn">Ajouter ESI</button>
<button class="red" id="delEsiBtn">Supprimer dernier ESI</button>
</input></input></input></input></input></input></div>
<div class="small-note">Tous les champs doivent √™tre remplis pour ajouter un ESI</div>
</div>
</div>
<!-- Page Passeurs -->
<div class="page" id="passeurPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Passeur(s) Intercept√©(s)</div>
</div>
<div class="page-content">
<div id="passeurList"></div>
<div style="margin-top: 20px;">
<input id="passeurAge" placeholder="Majeur(e) ou mineur(e) automatique" readonly="" type="text">
<select aria-label="Sexe H/F" id="passeurSexe">
<option value="">Homme/Femme</option>
<option value="Homme">Homme</option>
<option value="Femme">Femme</option>
</select>
<input id="passeurAgeNum" min="0" placeholder="√Çge (chiffre)" style="width: 100px;" type="number">
<input id="passeurNationalite" placeholder="Nationalit√©" type="text"/>
<input id="passeurLieu" placeholder="Lieu interpellation" type="text"/>
<label for="passeurHeure">Heure interpellation :</label>
<input id="passeurHeure" type="time"/>
<input id="passeurSuites" placeholder="Suites donn√©es" type="text"/>
<button class="blue" id="addPasseurBtn">Ajouter Passeur</button>
<button class="red" id="delPasseurBtn">Suppr. dernier Passeur</button>
</input></input></div>
<div class="small-note">Tous les champs doivent √™tre remplis pour ajouter un passeur</div>
</div>
</div>
<!-- Page Observations -->
<div class="page" id="observationsPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Observations</div>
</div>
<div class="page-content">
<textarea id="observations" oninput="this.style.height='auto'; this.style.height=this.scrollHeight+'px';" placeholder="Difficult√©s √©ventuelles (tablette, t√©l√©phone, v√©hicule, ...)
Autres‚Ä¶"></textarea>
</div>
</div>
<!-- Saisie rapide Heure + Actions -->
<section id="temps_action" style="margin-bottom:12px">
  <fieldset style="border:2px solid var(--bleuFonce,#003366);border-radius:10px;padding:10px">
    <legend style="padding:0 6px">Heure & actions</legend>

    <label style="display:block;margin-top:6px">Heure</label>
    <input type="time" id="heure_action" />

    <label style="display:block;margin-top:6px">ESI (optionnel)</label>
    <select id="esi_select">
      <option value="">‚Äî Aucun ‚Äî</option>
      <option>ESI 1</option><option>ESI 2</option><option>ESI 3</option>
      <option>ESI 4</option><option>ESI 5</option><option>ESI 6</option>
      <option>ESI 7</option><option>ESI 8</option><option>ESI 9</option>
      <option>ESI 10</option>
    </select>

    <label style="display:block;margin-top:6px">Action pr√©d√©finie (optionnel)</label>
    <select id="type_action" onchange="majAffichageComptage()">
      <option value="">‚Äî S√©lectionner ‚Äî</option>
      <option>D√©part de la caserne Ausseur</option>
      <option>Arriv√©e √† la caserne Ausseur</option>
      <option>D√©part en mission</option>
      <option>Retour de mission</option>
      <option>Contr√¥le routier</option>
      <option>Train italien</option>
      <option>Train fran√ßais</option>
    </select>

    <label style="display:block;margin-top:6px">Texte libre (optionnel)</label>
    <input id="texte_libre" placeholder="Ex. Train italien / Patrouille p√©destre‚Ä¶" oninput="majAffichageComptage()" />

    <div id="bloc_comptage" style="display:none;margin-top:8px">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <div>
          <label>Personnes contr√¥l√©es</label>
          <input type="number" id="nb_controles" min="0" placeholder="Ex. 48" />
        </div>
        <div>
          <label>Descendus sur le quai</label>
          <input type="number" id="nb_descendus" min="0" placeholder="Ex. 18" />
        </div>
      </div>
    </div>

    <button type="button" onclick="ajouterDeroulementFlex()" style="margin-top:10px;background:#003366;color:#fff;border:none;padding:6px 12px;border-radius:6px;cursor:pointer">
      Ajouter au d√©roulement
    </button>
  </fieldset>
</section>

<!-- Page D√©roulement -->
<div class="page" id="deroulementPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">D√©roulement de la mission</div>
</div>
<div class="page-content">
<textarea id="deroulement" oninput="this.style.height='auto'; this.style.height=this.scrollHeight+'px';" placeholder="D√©roulement d√©taill√©..."></textarea>
</div>
</div>
<!-- Page Pulsar -->
<div class="page" id="pulsarPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">PULSAR</div>
</div>
<div class="page-content">
<div style="text-align: center; margin-top: 50px;">
<label>
<input id="pulsarOui" name="pulsar" onclick="onPulsarChange()" type="radio"/>
<span class="yes">OUI</span>
</label>
<label>
<input id="pulsarNon" name="pulsar" onclick="onPulsarChange()" type="radio"/>
<span class="no">NON</span>
</label>
</div>
</div>
</div>
<!-- Page Fiche identit√© (int√©gration ESI+Visa - partie Fiche) -->
<div class="page" id="ficheIdentitePage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Fiche identit√©</div>
</div>
<div class="page-content">
<!-- Ici on int√©grera le formulaire complet ESI (prochaine √©tape) -->
<div id="ficheIdentiteApp">
<form id="ficheForm">
<label>Cat√©gorie :
      <select id="categorie">
<option value="ESI">ESI</option>
<option value="PASSEUR">PASSEUR</option>
</select>
</label>
<h2>Identit√©</h2>
<label>Nom<input autocomplete="off" id="nom" required="" type="text"/></label>
<label>Pr√©nom<input autocomplete="off" id="prenom" required="" type="text"/></label>
<label>Sexe
      <select id="sexe">
<option value="">--S√©lectionner--</option>
<option value="Masculin">Masculin</option>
<option value="F√©minin">F√©minin</option>
<option value="Autre">Autre</option>
</select>
</label>
<label>Nationalit√©<input autocomplete="off" id="nationalite" type="text"/></label>
<label>Date de naissance :</label>
<div class="date-naissance">
<input id="jour" max="31" min="1" placeholder="JJ" required="" type="number"/>
<input id="mois" max="12" min="1" placeholder="MM" required="" type="number"/>
<input id="annee" max="2100" min="1900" placeholder="AAAA" required="" type="number"/>
</div>
<label>√Çge<input id="age" readonly="" type="number"/></label>
<h2>Intervention</h2>
<label>Heure et Date d'intervention :</label>
<div class="heure-date">
<input id="heure" required="" type="time"/>
<input id="dateIntervention" required="" type="date"/>
</div>
<label>Lieu d'interpellation<input autocomplete="off" id="lieuInterpellation" type="text"/></label>
<label>Suites donn√©es<input autocomplete="off" id="suitesDonnees" type="text"/></label>
<h2>Voyage</h2>
<label>Ville de d√©part<input autocomplete="off" id="villeDepart" type="text"/></label>
<label>Pays de d√©part<input autocomplete="off" id="paysDepart" type="text"/></label>
<label>Ville de destination<input autocomplete="off" id="villeDestination" type="text"/></label>
<label>Pays de destination<input autocomplete="off" id="paysDestination" type="text"/></label>
<h2>V√©hicule</h2>
<label>Type de v√©hicule<input autocomplete="off" id="vehicule" type="text"/></label>
<label>Immatriculation<input autocomplete="off" id="immatriculation" type="text"/></label>
<h2>Pi√®ces d'identit√© pr√©sent√©es</h2>
<div id="piecesIdentite">
<label><input name="piece" type="checkbox" value="Passeport valide"/> Passeport valide</label>
<label><input name="piece" type="checkbox" value="Passeport p√©rim√©"/> Passeport p√©rim√©</label>
<label><input name="piece" type="checkbox" value="Fiche de demande d'asile valide"/> Fiche de demande d'asile valide</label>
<label><input name="piece" type="checkbox" value="Fiche de demande d'asile p√©rim√©e"/> Fiche de demande d'asile p√©rim√©e</label>
<label><input name="piece" type="checkbox" value="Carte d'identit√© valide"/> Carte d'identit√© valide</label>
<label><input name="piece" type="checkbox" value="Carte d'identit√© p√©rim√©e"/> Carte d'identit√© p√©rim√©e</label>
<label><input name="piece" type="checkbox" value="Titre de s√©jour valide"/> Titre de s√©jour valide</label>
<label><input name="piece" type="checkbox" value="Titre de s√©jour p√©rim√©"/> Titre de s√©jour p√©rim√©</label>
<label><input id="autreCheck" name="piece" type="checkbox" value=""/> Autre :</label>
</div>
<input disabled="" id="autreTexte" placeholder="Pr√©cisez..." style="width:100%;margin-top:5px;padding:8px;" type="text"/>
<button class="blue" type="submit">Enregistrer la fiche</button>
</form>
<h2>Historique des fiches</h2>
<div id="historique"></div>
<button class="red" id="effacerFiches">Effacer toutes les fiches</button>
</div>
</div>
</div>
<!-- Page Assistant Visas (int√©gration ESI+Visa - partie Assistant) -->
<div class="page" id="assistantVisaPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Assistant Visas</div>
</div>
<div class="page-content">
<!-- Ici on int√©grera l'Assistant Visa France (prochaine √©tape) -->
<div id="assistantVisaApp">
<h2>Mini Assistant Visa France</h2>
<label for="paysInput">S√©lectionnez votre pays :</label><br/>
<div class="autocomplete-container">
<input autocomplete="off" id="paysInput" placeholder="Tapez le nom du pays..." type="text"/>
<div id="paysDropdown"></div>
</div><br/>
<label for="duree">Type de s√©jour :</label><br/>
<select id="duree">
<option value="court">Courte dur√©e (&lt;90 jours)</option>
<option value="long">Longue dur√©e (&gt;90 jours)</option>
</select><br/>
<p id="resultat"></p>
<p>LIENS UTILES:</p> <a href="https://www.visa-schengen.info/voyager-en-europe/pays-exemptes/" target="blank">Pays exempt√©s de visas</a><br/><br/>
<a href="https://www.visa-schengen.info/voyager-en-europe/pays-concernes/" target="blank">Pays concern√©s</a><br/><br/>
<a href="https://www.immigration.interieur.gouv.fr/fr/Immigration/Les-visas" target="blank">Les visas/immigration</a>
</div>
</div>
</div>
<!-- Page Compte Rendu -->
<div class="page" id="generatePage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">Compte Rendu</div>
</div>
<div class="page-content">
<div style="text-align:center; margin-bottom: 20px;">
<button class="blue" id="generateBtn" style="padding:12px 24px; font-size:1.1em;">G√©n√©rer compte rendu</button>
<button class="green" id="copyBtn" style="padding:12px 24px; font-size:1.1em;">Copier dans le presse-papiers</button>
<button class="red" id="resetBtn" style="font-size:1.1em;">Effacer les donn√©es sauvegard√©es</button>
</div>
<h3>Compte rendu g√©n√©r√© :</h3>
<textarea id="compteRendu" readonly="" style="font-family:Verdana; white-space:pre-wrap; overflow:hidden;"></textarea>
</div>
</div>
<!-- Page QR Code -->
<div class="page" id="qrPage">
<div class="page-header">
<button class="back-button" onclick="showPage('homePage')">
<i class="fas fa-arrow-left"></i> Retour
    </button>
<div class="page-title">QR Codes scann√©s</div>
</div>
<div class="page-content">
<h3>R√©sum√© des ESR (scann√©s)</h3>
<textarea id="resumeEsr" readonly="" rows="6" style="font-family:Verdana; white-space:pre-wrap; overflow:hidden;"></textarea>
<div class="small-note">
      Scann√©s: <span id="nbScans">0</span> | NIGEND: <span id="nigendList">‚Äî</span>
</div>
</div>
</div>
<!-- QR Modal -->
<div id="qrModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:1000; align-items:center; justify-content:center;">
<div style="background:#fff; padding:20px; border-radius:10px; max-width:600px; width:90%;">
<h2>Scanner un QR code</h2>
<div id="qr-reader" style="width:100%;"></div>
<div id="scanLog" style="max-height:120px; overflow:auto; margin-top:10px; font-size:0.9em; background:#f0f0f0; padding:6px;"></div>
<button onclick="closeQrModal()" style="margin-top:10px; padding:8px 16px;">Fermer</button>
</div>
</div>
    <!-- PAGE PROC√àS-VERBAL -->
<div id="pvPage" class="page">
  <div class="page-header">
    <button class="back-button" onclick="showPage('homePage')">
      <i class="fas fa-arrow-left"></i> Retour
    </button>
    <div class="page-title">Proc√®s-verbal</div>
  </div>

  <iframe
    id="pvFrame"
    src="./pv/index.html"
    style="
      width: 100%;
      height: 85vh;
      border: none;
      background: white;
      overflow: auto;
    "
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-downloads"
    allow="clipboard-write; clipboard-read; fullscreen">
  </iframe>
</div>

</body>
</html>
